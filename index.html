<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Class Chat Live</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
html, body { margin:0; padding:0; height:100%; font-family:"Georgia", sans-serif; background:#1e1b2d; color:#dcd6f7; display:flex; flex-direction:column; }
header { padding:12px 20px; background:#4b3b77; display:flex; justify-content:space-between; align-items:center; font-size:1.1rem; }
header span { opacity:0.85; }
#username { background:#2b2244; border:1px solid #6658a8; color:#e0d9ff; padding:6px 10px; border-radius:4px; width:130px; font-size:1rem; }
#chat { flex:1; overflow-y:auto; padding:12px 16px; scrollbar-width: thin; scrollbar-color: #7fa1ff #2b2244; }
#chat::-webkit-scrollbar { width:8px; }
#chat::-webkit-scrollbar-thumb { background-color:#7fa1ff; border-radius:4px; }
.msg { margin-bottom:10px; padding:8px 12px; border-radius:6px; background:#3a2e66; max-width:85%; word-wrap:break-word; color:#e0d9ff; }
.me { background:#5a7fff; margin-left:auto; text-align:right; color:#fff; }
.meta { font-size:0.75rem; opacity:0.7; margin-bottom:2px; }
.text { font-size:1rem; }
#form { display:flex; padding:10px 16px; background:#4b3b77; gap:8px; }
#message { flex:1; padding:10px; border-radius:4px; border:1px solid #6658a8; background:#2b2244; color:#e0d9ff; font-size:1rem; }
#send, #clear { padding:10px 16px; border:none; border-radius:4px; font-weight:bold; font-size:1rem; cursor:pointer; }
#send { background:#7fa1ff; color:#111b33; }
#send:disabled { opacity:0.5; cursor:default; }
#clear { background:#b49fff; color:#111b33; margin-left:8px; }
</style>
</head>
<body>
<header>
  <div><strong>Class Chat</strong></div>
  <div>
    <span>Name:</span>
    <input id="username" placeholder="you">
  </div>
</header>
<div id="chat"></div>
<form id="form">
  <input id="message" autocomplete="off" placeholder="Type a message...">
  <button id="send" type="submit">Send</button>
  <button type="button" id="clear">Clear Chat</button>
</form>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script>
  // ðŸ”¥ Your Firebase config ðŸ”¥
  const firebaseConfig = {
    apiKey: "AIzaSyD9GQMi0v4ItnkJ2uqKtUUQU59DorLrCAg",
    authDomain: "live-chat-3d2c3.firebaseapp.com",
    projectId: "live-chat-3d2c3",
    storageBucket: "live-chat-3d2c3.firebasestorage.app",
    messagingSenderId: "550798266942",
    appId: "1:550798266942:web:2ce678f70e4f64d6f7376f",
    measurementId: "G-L0K72L8894"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  const chatEl = document.getElementById("chat");
  const formEl = document.getElementById("form");
  const msgInput = document.getElementById("message");
  const userInput = document.getElementById("username");
  const clearBtn = document.getElementById("clear");
  const TEACHER_PASSWORD = "teacher123";

  function addMessage(msg, isMe){
    const wrap = document.createElement("div");
    wrap.className = "msg" + (isMe ? " me" : "");
    wrap.innerHTML = `<div class="meta">${msg.name} â€¢ ${new Date(msg.time).toLocaleTimeString()}</div>
                      <div class="text">${msg.text}</div>`;
    chatEl.appendChild(wrap);
    chatEl.scrollTop = chatEl.scrollHeight;
  }

  // Listen to messages live
  db.collection("messages").orderBy("time")
    .onSnapshot(snapshot=>{
      chatEl.innerHTML = "";
      snapshot.forEach(doc=>{
        const m = doc.data();
        addMessage(m, m.name === (userInput.value.trim()||"anon"));
      });
    });

  // Send message
  formEl.addEventListener("submit", e=>{
    e.preventDefault();
    const text = msgInput.value.trim();
    if(!text) return;
    db.collection("messages").add({
      name: userInput.value.trim()||"anon",
      text,
      time: Date.now()
    });
    msgInput.value = "";
  });

  // Clear chat button
  clearBtn.addEventListener("click", ()=>{
    const pass = prompt("Teacher password:");
    if(pass !== TEACHER_PASSWORD) return alert("Wrong password");
    db.collection("messages").get().then(snap=>{
      snap.forEach(doc => doc.ref.delete());
    }).then(()=> alert("Chat cleared!"));
  });
</script>
</body>
</html>